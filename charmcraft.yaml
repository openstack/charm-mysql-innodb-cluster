type: charm

parts:
  charm:
    plugin: reactive
    reactive-charm-build-arguments:
    - --verbose
    - --use-lock-file-branches
    build-packages:
    - tox
    - git
    - python3-dev
    - libffi-dev
    - libmysqlclient-dev
    - pkg-config
    source: src/
    build-snaps:
    - charm
    build-environment:
    - CHARM_INTERFACES_DIR: $CRAFT_PROJECT_DIR/interfaces/
    - CHARM_LAYERS_DIR: $CRAFT_PROJECT_DIR/layers/
bases:
  - build-on:
      - name: ubuntu
        channel: "20.04"
        architectures:
          - amd64
    run-on:
      - name: ubuntu
        channel: "20.04"
        architectures: [amd64, s390x, ppc64el, arm64]
      - name: ubuntu
        channel: "22.04"
        architectures: [amd64, s390x, ppc64el, arm64]
